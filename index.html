<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MMM 教學｜找山數 → 方向 → 離場點 → 進場點</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0c0e14;
      --bg-subtle: #12151d;
      --surface: rgba(255, 255, 255, 0.04);
      --surface-hover: rgba(255, 255, 255, 0.07);
      --border: rgba(255, 255, 255, 0.08);
      --text: #eef1f6;
      --text-muted: #8b92a5;
      --accent: #00d4aa;
      --accent-glow: rgba(0, 212, 170, 0.25);
      --accent-dim: #00b894;
      --blue: #5c7cfa;
      --blue-dim: rgba(92, 124, 250, 0.2);
      --orange: #ff9f43;
      --radius: 12px;
      --radius-sm: 8px;
      --shadow: 0 4px 24px rgba(0, 0, 0, 0.3);
      --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    *, *::before, *::after { box-sizing: border-box; }

    html {
      scroll-behavior: smooth;
    }

    body {
      margin: 0;
      font-family: 'Noto Sans TC', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.7;
      min-height: 100vh;
      padding: 0 env(safe-area-inset-right) 0 env(safe-area-inset-left);
    }

    /* Layout: 螢幕置中，sidebar + main（密碼通過後才顯示） */
    #app-content {
      display: none;
    }
    body.unlocked #app-content {
      display: flex;
    }
    .app {
      display: flex;
      min-height: 100vh;
      max-width: 960px;
      margin: 0 auto;
      box-shadow: 0 0 0 1px var(--border);
    }

    .sidebar {
      width: 220px;
      flex-shrink: 0;
      position: sticky;
      top: 0;
      height: 100vh;
      padding: 1.5rem 0;
      background: var(--bg-subtle);
      border-right: 1px solid var(--border);
      overflow-y: auto;
    }

    .sidebar-title {
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-muted);
      padding: 0 1.25rem;
      margin-bottom: 0.75rem;
    }

    .nav-step {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.6rem 1.25rem;
      margin: 0 0.5rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      text-decoration: none;
      color: var(--text-muted);
      font-size: 0.9rem;
      transition: background var(--transition), color var(--transition);
    }

    .nav-step:hover {
      background: var(--surface-hover);
      color: var(--text);
    }

    .nav-step.active {
      background: var(--accent-glow);
      color: var(--accent);
      font-weight: 500;
    }

    .nav-step-num {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      background: rgba(255,255,255,0.06);
      color: var(--text-muted);
      font-size: 0.75rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .nav-step.active .nav-step-num {
      background: var(--accent);
      color: var(--bg);
    }

    .main {
      flex: 1;
      min-width: 0;
      max-width: 680px;
      padding: 2rem 2.5rem 4rem;
      padding-left: max(2rem, env(safe-area-inset-left));
      padding-right: max(2.5rem, env(safe-area-inset-right));
    }

    /* Hero */
    .hero {
      text-align: center;
      margin-bottom: 2rem;
    }

    .hero-badge {
      display: inline-block;
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 0.15em;
      color: var(--accent);
      background: var(--accent-glow);
      padding: 0.35rem 0.85rem;
      border-radius: 999px;
      margin-bottom: 1rem;
    }

    .hero h1 {
      font-size: 1.85rem;
      font-weight: 700;
      margin: 0 0 0.5rem;
      background: linear-gradient(135deg, #fff 0%, var(--text-muted) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero p {
      color: var(--text-muted);
      font-size: 0.95rem;
      margin: 0;
    }

    /* Accordion sections */
    .section {
      margin-bottom: 0.5rem;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--surface);
      overflow: hidden;
      transition: border-color var(--transition), box-shadow var(--transition);
    }

    .section:hover {
      border-color: rgba(255,255,255,0.12);
    }

    .section.open {
      border-color: rgba(0, 212, 170, 0.35);
      box-shadow: 0 0 0 1px rgba(0, 212, 170, 0.1);
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.25rem;
      cursor: pointer;
      user-select: none;
      transition: background var(--transition);
    }

    .section-header:hover {
      background: var(--surface-hover);
    }

    .section-num {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dim) 100%);
      color: var(--bg);
      font-size: 0.9rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .section-title {
      flex: 1;
      font-size: 1.05rem;
      font-weight: 600;
      margin: 0;
    }

    .section-chevron {
      width: 24px;
      height: 24px;
      color: var(--text-muted);
      transition: transform var(--transition);
    }

    .section.open .section-chevron {
      transform: rotate(180deg);
      color: var(--accent);
    }

    .section-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .section.open .section-body {
      max-height: 1200px;
    }

    .section-inner {
      padding: 0 1.25rem 1.25rem;
      border-top: 1px solid var(--border);
    }

    .section-inner ul, .section-inner ol {
      margin: 0 0 1rem;
      padding-left: 1.4rem;
    }

    .section-inner li { margin-bottom: 0.35rem; }

    .section-inner p { margin: 0 0 0.75rem; }

    .section-inner strong { color: #fff; font-weight: 600; }

    /* Cards inside sections */
    .card {
      background: rgba(0,0,0,0.2);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      padding: 1rem 1.2rem;
      margin: 0.75rem 0;
      transition: border-color var(--transition), transform var(--transition);
    }

    .card:hover {
      border-color: rgba(0, 212, 170, 0.2);
    }

    .card h4 {
      font-size: 0.9rem;
      font-weight: 600;
      margin: 0 0 0.5rem;
      color: var(--accent);
    }

    /* SDD / SDU 分類標籤 */
    .identity-block {
      margin: 1rem 0;
    }
    .identity-tag {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem 0.6rem;
      border-radius: 6px;
      margin-bottom: 0.5rem;
    }
    .identity-tag.sdd {
      background: rgba(0, 212, 170, 0.2);
      color: var(--accent);
      border: 1px solid rgba(0, 212, 170, 0.4);
    }
    .identity-tag.sdu {
      background: rgba(92, 124, 250, 0.2);
      color: var(--blue);
      border: 1px solid rgba(92, 124, 250, 0.4);
    }
    .identity-block .card { margin: 0.5rem 0 0; }

    .card ul { margin: 0; padding-left: 1.2rem; }
    .card li { margin-bottom: 0.25rem; }

    /* Tables */
    .table-wrap {
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      overflow: auto;
      margin: 1rem 0;
      -webkit-overflow-scrolling: touch;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88rem;
    }

    th, td {
      padding: 0.7rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    th {
      background: rgba(255,255,255,0.04);
      font-weight: 600;
      color: var(--text);
    }

    tr:last-child td { border-bottom: none; }

    tr {
      transition: background var(--transition);
    }

    tbody tr:hover {
      background: var(--surface-hover);
    }

    /* Highlight box */
    .highlight-box {
      background: rgba(0, 212, 170, 0.08);
      border: 1px solid rgba(0, 212, 170, 0.25);
      border-radius: var(--radius-sm);
      padding: 1rem 1.2rem;
      margin: 1rem 0;
    }

    .highlight-box p { margin: 0; }

    /* Interactive flow */
    .flow-section {
      margin: 2rem 0;
    }

    .flow-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
      margin-bottom: 1rem;
    }

    .flow-steps {
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .flow-step {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.65rem 1rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: background var(--transition), color var(--transition);
      border: 1px solid transparent;
    }

    .flow-step:hover {
      background: var(--surface-hover);
      color: var(--text);
    }

    .flow-step.highlight {
      background: var(--accent-glow);
      border-color: rgba(0, 212, 170, 0.3);
      color: var(--accent);
    }

    .flow-step-arrow {
      width: 20px;
      color: var(--accent);
      opacity: 0.7;
      font-size: 1rem;
      text-align: center;
    }

    .flow-step-text {
      flex: 1;
      font-size: 0.9rem;
    }

    /* End note */
    .end-note {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px solid var(--border);
    }

    /* 首頁：選擇 SDD / SDU */
    .home-page {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      min-height: 60vh;
    }
    .home-page .hero {
      margin-bottom: 2.5rem;
    }
    .choice-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
      max-width: 560px;
    }
    .choice-card {
      display: block;
      width: 220px;
      padding: 2rem 1.5rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      text-decoration: none;
      color: var(--text);
      text-align: center;
      transition: border-color var(--transition), transform var(--transition), box-shadow var(--transition);
    }
    .choice-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.25);
    }
    .choice-card.sdu:hover {
      border-color: var(--blue);
    }
    .choice-card-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin: 0 0 0.35rem;
    }
    .choice-card.sdd .choice-card-title { color: var(--accent); }
    .choice-card.sdu .choice-card-title { color: var(--blue); }
    .choice-card-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin: 0;
    }

    /* Responsive：平板 */
    @media (max-width: 900px) {
      .app {
        flex-direction: column;
        max-width: 100%;
        box-shadow: none;
      }
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
        padding: 0.75rem max(1rem, env(safe-area-inset-left));
        padding-right: max(1rem, env(safe-area-inset-right));
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
      .sidebar-title { width: 100%; padding: 0 0.5rem; margin-bottom: 0.5rem; }
      .nav-step { padding: 0.5rem 0.75rem; margin: 0; font-size: 0.8rem; }
      .main {
        padding: 1.25rem max(1.25rem, env(safe-area-inset-left)) 3rem max(1.25rem, env(safe-area-inset-right));
      }
      .hero h1 { font-size: 1.45rem; }
    }

    /* 密碼進入畫面 */
    .password-gate {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    body.unlocked .password-gate {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    .gate-box {
      width: 100%;
      max-width: 320px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 2rem;
      box-shadow: var(--shadow);
    }
    .gate-box h2 {
      margin: 0 0 0.5rem;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text);
      text-align: center;
    }
    .gate-box p {
      margin: 0 0 1.25rem;
      font-size: 0.9rem;
      color: var(--text-muted);
      text-align: center;
    }
    .gate-box input[type="password"] {
      width: 100%;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      font-size: 1rem;
      font-family: inherit;
      color: var(--text);
      background: var(--bg-subtle);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      outline: none;
      transition: border-color var(--transition);
    }
    .gate-box input[type="password"]:focus {
      border-color: var(--accent);
    }
    .gate-box input[type="password"]::placeholder {
      color: var(--text-muted);
    }
    .gate-box button {
      width: 100%;
      padding: 0.75rem 1rem;
      font-size: 0.95rem;
      font-weight: 600;
      font-family: inherit;
      color: var(--bg);
      background: var(--accent);
      border: none;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: background var(--transition), opacity var(--transition);
    }
    .gate-box button:hover {
      background: var(--accent-dim);
    }
    .gate-box button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }
    .gate-error {
      font-size: 0.85rem;
      color: #f87171;
      text-align: center;
      margin-top: 0.75rem;
      min-height: 1.25em;
    }

    /* Responsive：手機 */
    @media (max-width: 480px) {
      .main {
        padding: 1rem max(1rem, env(safe-area-inset-left)) 2.5rem max(1rem, env(safe-area-inset-right));
      }
      .hero h1 { font-size: 1.28rem; }
      .hero-badge { font-size: 0.65rem; padding: 0.3rem 0.65rem; }
      .section-header { padding: 0.85rem 1rem; }
      .section-num { width: 32px; height: 32px; font-size: 0.85rem; }
      .section-title { font-size: 0.95rem; }
      .section-inner { padding: 0 1rem 1rem; }
      .card { padding: 0.85rem 1rem; }
      .card h4 { font-size: 0.85rem; }
      table { font-size: 0.82rem; }
      th, td { padding: 0.55rem 0.75rem; }
      .flow-step-text { font-size: 0.82rem; }
      .nav-step { padding: 0.45rem 0.6rem; font-size: 0.75rem; }
      .nav-step-num { width: 20px; height: 20px; font-size: 0.7rem; }
    }
  </style>
</head>
<body>
  <div class="password-gate" id="password-gate">
    <div class="gate-box">
      <h2>MMM 教學</h2>
      <p>請輸入密碼以進入</p>
      <form id="gate-form" autocomplete="off">
        <input type="password" id="gate-input" placeholder="請輸入密碼" autocomplete="off" required>
        <button type="submit" id="gate-btn">進入</button>
      </form>
      <div class="gate-error" id="gate-error" aria-live="polite"></div>
    </div>
  </div>

  <div class="app" id="app-content">
    <div class="home-page">
      <header class="hero">
        <span class="hero-badge">MMM 教學</span>
        <h1>請選擇要查看的教學</h1>
        <p>找山數 → 方向 → 離場點 → 進場點</p>
      </header>
      <div class="choice-cards">
        <a href="sdd.html" class="choice-card sdd">
          <div class="choice-card-title">SDD MMM</div>
          <p class="choice-card-desc">方向 1H SDD · 弟弟 30 分 · 哥哥 2H/4H · 離場 8H OWU</p>
        </a>
        <a href="sdu.html" class="choice-card sdu">
          <div class="choice-card-title">SDU MMM</div>
          <p class="choice-card-desc">方向 2H SDU · 弟弟 1H · 哥哥 4H · 離場 8H OWD（鏡射）</p>
        </a>
      </div>
    </div>
  </div>

  <script>
    (function() {
      var GATE_KEY = 'mmm_ok';
      // 密碼經 SHA-256 雜湊，原始密碼不會出現在程式碼中
      var HASH_HEX = '41fabdb1ccf1a6c4d170e3d6fdd89d21f7be4e1379d2ca0f215587d3ed9cc498';

      function unlock() {
        try { sessionStorage.setItem(GATE_KEY, '1'); } catch (e) {}
        document.body.classList.add('unlocked');
      }

      function hashPassword(str) {
        return crypto.subtle.digest('SHA-256', new TextEncoder().encode(str))
          .then(function(buf) {
            return Array.from(new Uint8Array(buf))
              .map(function(x) { return x.toString(16).padStart(2, '0'); })
              .join('');
          });
      }

      if (sessionStorage.getItem(GATE_KEY) === '1') {
        unlock();
      } else {
        var form = document.getElementById('gate-form');
        var input = document.getElementById('gate-input');
        var err = document.getElementById('gate-error');
        var btn = document.getElementById('gate-btn');
        if (form) {
          form.addEventListener('submit', function(e) {
            e.preventDefault();
            err.textContent = '';
            var val = (input.value || '').trim();
            if (!val) { err.textContent = '請輸入密碼'; return; }
            btn.disabled = true;
            btn.textContent = '驗證中…';
            hashPassword(val).then(function(hex) {
              if (hex === HASH_HEX) {
                btn.textContent = '進入中…';
                unlock();
              } else {
                err.textContent = '密碼錯誤，請再試一次';
                input.value = '';
                input.focus();
                btn.disabled = false;
                btn.textContent = '進入';
              }
            }).catch(function() {
              err.textContent = '驗證失敗，請再試一次';
              btn.disabled = false;
              btn.textContent = '進入';
            });
          });
        }
      }

      // Accordion: click header to toggle
      document.querySelectorAll('.section-header').forEach(function(header) {
        header.addEventListener('click', function() {
          var section = this.closest('.section');
          var wasOpen = section.classList.contains('open');
          document.querySelectorAll('.section').forEach(function(s) { s.classList.remove('open'); });
          if (!wasOpen) section.classList.add('open');
        });
      });

      // Sidebar: active state by scroll position
      var sections = document.querySelectorAll('.section');
      var navSteps = document.querySelectorAll('.nav-step[data-section]');

      function updateActiveNav() {
        var scrollY = window.scrollY;
        var inner = document.querySelector('.main');
        var top = inner ? inner.offsetTop : 0;

        var current = null;
        sections.forEach(function(section) {
          var id = section.getAttribute('data-section');
          var el = document.getElementById('section-' + id) || document.getElementById(id);
          if (!el) return;
          var rect = el.getBoundingClientRect();
          if (rect.top <= 120 && rect.bottom > 150) current = id;
        });
        if (!current && document.getElementById('flow') && document.getElementById('flow').getBoundingClientRect().top <= 200) current = 'flow';

        navSteps.forEach(function(step) {
          var sid = step.getAttribute('data-section');
          step.classList.toggle('active', sid === current);
        });
      }

      window.addEventListener('scroll', function() { requestAnimationFrame(updateActiveNav); });
      window.addEventListener('load', updateActiveNav);

      // Flow steps: click to scroll and open section
      document.querySelectorAll('.flow-step[data-goto]').forEach(function(step) {
        step.addEventListener('click', function() {
          var id = this.getAttribute('data-goto');
          var target = document.getElementById(id);
          if (!target) return;
          document.querySelectorAll('.section').forEach(function(s) { s.classList.remove('open'); });
          target.closest('.section').classList.add('open');
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.flow-step').forEach(function(s) { s.classList.remove('highlight'); });
          var flowStep = document.querySelector('.flow-step[data-goto="' + id + '"]');
          if (flowStep) flowStep.classList.add('highlight');
          setTimeout(function() { if (flowStep) flowStep.classList.remove('highlight'); }, 2000);
        });
      });
    })();
  </script>
</body>
</html>
